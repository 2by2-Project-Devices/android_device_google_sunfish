type hardware_info_app, domain;

app_domain(hardware_info_app)

## Seploicy requset by HardwareInfoService
allow hardware_info_app activity_service:service_manager find;

##
## Seploicy requset by libhwinfo.jar
##
# android.os.Build.getSerial
allow hardware_info_app device_identifiers_service:service_manager find;

# putStorageHealthInfo
dontaudit hardware_info_app sysfs:file r_file_perms;

# Batteryinfo
allow hardware_info_app sysfs_batteryinfo:dir search;
allow hardware_info_app sysfs_batteryinfo:file r_file_perms;

# putStorage
allow hardware_info_app sysfs_scsi_devices_0000:dir search;
allow hardware_info_app sysfs_scsi_devices_0000:file r_file_perms;

# putApplicationProcessor
dontaudit hardware_info_app sysfs_soc:dir search;
dontaudit hardware_info_app sysfs_soc:file { getattr open read };

# Display
allow hardware_info_app sysfs_display:dir search;
allow hardware_info_app sysfs_display:file r_file_perms;
